Create by **fall** on 13 Dec 2022
Recently revised in 25 Apr 2024

## node 中间层

中间层：作为**浏览器**和**服务器**之间的处理进行使用

客户端原本直接向 Server 发送请求，Server 收到请求之后将信息传递给浏览器。如今浏览器会将请求发送给node 层，node 层将信息进行处理之后在想 server 层发送请求，Server 层处理完毕将响应结果返回给 node 层，node 层最后将数据返回给浏览器。

```
请求数据：
原来：
客户端 --->  服务端
现在：
客户端 ---> 中间件 ---> 服务端

响应数据：
原来：
客户端 <---  服务端
现在：
客户端 <--- 中间件 <--- 服务端
```

## 为什么使用中间层

`node层` 可以向 `server` 层获取数据，再通过对数据的计算整合转换成符合前端 `UI` 要求的数据格式。另外整个应用如果采用微服务架构,那么 `Server层` 会有很多台管理单独业务模块的服务器，`node层` 就很好的适配了微服务的架构，它可以向多台服务器发起请求获取到不同模块的数据再整合转化发送给前端.

浏览器首先将请求发送给 `node服务器`，请求收到后 `node服务器` 可以对请求做一些处理，比如将原来的路径变换一下，请求头的信息改变一下，再把修改后的请求发送给远程真实的服务器。

远程服务器计算出响应结果再返回给 `node服务器`，`node服务器` 仍然可以对响应做选择性处理再分返回给浏览器。

代理转发*可以解决前端日常开发中经常遇到的跨域问题*，另外它还屏蔽了远程真实服务器的细节，让浏览器只与 `node服务器` 通信。

回头再写吧，这个技术不懂诶

链接：https://juejin.cn/post/6918260779472912392



## Process

通过 `process.cwd()` 获取当前工作目录 (current working directory)，命令启动时的目录

### Env

process.env

node > 20.6.0，之后默认引入 .env 功能，在 `.env` 文件中

## IO 

你要拷贝一个 20G 大的文件, 如果你一次性将 20G 的数据读入到内存, 你的内存条可能不够用,  或者严重影响性能. 但是你如果使用一个 1MB 大小的缓存 (buf) 每次读取 1Mb, 然后写入 1Mb, 那么不论这个文件多大都只会占用  1Mb 的内存.

而在 Node.js 中, 原理与上述 C 代码类似，不过在读写的实现上通过 libuv 与 EventEmitter 加上了异步的特性. 在 linux/unix 中你可以通过 `|` 来感受到流式操作.



> Create by **fall** on 2022-05-16
> Recently revised in 2022-11-18

JavaScript 语言自身只有字符串数据类型，没有二进制数据类型。

但在处理像TCP流或文件流时，必须使用到二进制数据。因此在 Node.js中，定义了一个 `Buffer` 类，该类用来创建一个专门存放二进制数据的缓存区。

在 Node.js 中，`Buffer` 类是随 Node 内核一起发布的核心库。`Buffer` 库为 Node.js 带来了一种存储原始数据的方法，可以让 Node.js 处理二进制数据，每当需要在 Node.js 中处理I/O操作中移动的数据时，就有可能使用 `Buffer` 库。原始数据存储在 `Buffer` 类的实例中。一个 `Buffer` 类似于一个整数数组，但它对应于 V8 堆内存之外的一块原始内存。
