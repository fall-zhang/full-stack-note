> Create by **fall** on 26 Jan 2025
> Recently revised in 26 Jan 2025

## docker build

docker build 使用 client-server 架构

- client：buildx，作为客户端以及用户界面去运行和管理 build
- server：BuildKit，用来执行 build 操作

## buildx

buildx 默认和 docker desktop 一同安装了

docker build 是对 buildx 的一层包装，当调用 docker build 时，buildx 会解析命令，并且发送一个 build 请求给 buildKit。

除了 build 之外，buildx 还可以创建和管理 BuildKit，以及提供一个 images 的注册表去管理，并且同时运行多个 build

> buildx 和 docker build 有一些潜在的区别，可以查看 [两者区别](https://docs.docker.com/build/builders/#difference-between-docker-build-and-docker-buildx-build)

### BuildKit

用于后台执行构建工作

在执行 docker build 之后，开始执行 build 工作，buildx 解释你的命令以及发送构建请求给 BuildKit，请求包括：Dockerfile、build 参数，导出配置，缓存配置。

BuildKit 解析这些构建的知道，并且执行这些步骤，在 BuildKit 执行的过程中，Buildx 监控 构建的状态，并且在命令行上输出这些步骤。

如果构建需要一些来自客户端的资源，比如本地文件以及构建密码，BuildKit 从 Buildx 中请求这些所需资源

## DockerFile

docker 通过从 Dockerfile 中读取指示来构建应用

Dockerfile 中最常用的部分

```dockerfile
# 定义一个基本的镜像
FROM <image>
# 在一个新的层内执行任何命令
```



## 参考文章

| 作者         | 文章名称                                                     |
| ------------ | ------------------------------------------------------------ |
| 爱笑的架构师 | [5分钟带你快速了解Docker和k8s](https://juejin.cn/post/6913568633813729294) |
| 佳庆         | [docker-compose讲解与安装](https://juejin.cn/post/7220730324752859195) |
| 官方文档     | https://docs.docker.com/get-started/02_our_app/              |
|              |                                                              |
|              |                                                              |
|              |                                                              |
|              |                                                              |
|              |                                                              |

